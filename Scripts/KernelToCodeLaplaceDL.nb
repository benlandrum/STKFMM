(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16602,        516]
NotebookOptionsPosition[     14742,        475]
NotebookOutlinePosition[     15130,        492]
CellTagsIndexPosition[     15087,        489]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.724499201604269*^9, 
  3.724499204717389*^9}},ExpressionUUID->"ca306d0f-2779-4ed0-90bd-\
61acd9304593"],

Cell[BoxData[
 RowBox[{
  RowBox[{"svec", "=", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sy", ",", "sz"}], "}"}]}], ";", 
  RowBox[{"tvec", "=", 
   RowBox[{"{", 
    RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7244992060428553`*^9, 3.724499224732497*^9}, {
   3.7245014438308477`*^9, 3.7245014904608183`*^9}, 
   3.7246080262028637`*^9},ExpressionUUID->"31153b42-4d17-40b9-bec3-\
631bf5c8d205"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LapSL", "[", 
   RowBox[{"rvec_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"q", "/", 
   RowBox[{"(", 
    RowBox[{"4", "*", "Pi", "*", 
     RowBox[{"Norm", "[", "rvec", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7245015162985783`*^9, 3.724501597176252*^9}, {
  3.7245016356569777`*^9, 3.724501637599868*^9}, {3.7246080288331547`*^9, 
  3.7246080467842617`*^9}},ExpressionUUID->"dbfa4bf7-de48-4992-b9db-\
2e2cd9ed38b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DL", "=", 
  RowBox[{"Grad", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"LapSL", "[", 
       RowBox[{
        RowBox[{"tvec", "-", "svec"}], ",", "1"}], "]"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{
        RowBox[{"tx", ">", "sx"}], "&&", 
        RowBox[{"ty", ">", "sy"}], "&&", 
        RowBox[{"tz", ">", "sz"}]}]}]}], "]"}], ",", "svec"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.724608391033949*^9, 
  3.724608450968041*^9}},ExpressionUUID->"977ba4e3-bb59-4c04-aa74-\
8b22d6728978"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"sx", "-", "tx"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"sy", "-", "ty"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"sz", "-", "tz"}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.724608421836576*^9, 
  3.724608451469006*^9}},ExpressionUUID->"c1078c33-0d28-40c6-b545-\
1185caea6461"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"potential", "=", 
  RowBox[{"DL", ".", 
   RowBox[{"{", 
    RowBox[{"dx", ",", "dy", ",", "dz"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.724608305127029*^9, 3.7246083592991877`*^9}, {
  3.724608427498904*^9, 
  3.724608427584024*^9}},ExpressionUUID->"037c486d-f3f3-46f7-9e4b-\
ccaa931331f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"dx", " ", 
     RowBox[{"(", 
      RowBox[{"sx", "-", "tx"}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "-", 
  FractionBox[
   RowBox[{"dy", " ", 
    RowBox[{"(", 
     RowBox[{"sy", "-", "ty"}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]], "-", 
  FractionBox[
   RowBox[{"dz", " ", 
    RowBox[{"(", 
     RowBox[{"sz", "-", "tz"}], ")"}]}], 
   RowBox[{"4", " ", "\[Pi]", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{{3.724608335151503*^9, 3.724608370227861*^9}, {
  3.7246084285110407`*^9, 
  3.724608453661384*^9}},ExpressionUUID->"dfc5f1bb-78ee-417b-9358-\
77cac8bd26b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"potential", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"potential", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{
      RowBox[{"tx", ">", "sx"}], "&&", 
      RowBox[{"ty", ">", "sy"}], "&&", 
      RowBox[{"tz", ">", "sz"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7245015996169777`*^9, 3.724501622153934*^9}, {
  3.724608051472252*^9, 3.724608058799665*^9}, {3.724608147710441*^9, 
  3.724608148757471*^9}, {3.724608374237167*^9, 
  3.724608374994708*^9}},ExpressionUUID->"ef8f4c78-f28f-4bff-ad9e-\
18ab9aa2d704"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"dx", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "sx"}], "+", "tx"}], ")"}]}], "+", 
   RowBox[{"dy", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "sy"}], "+", "ty"}], ")"}]}], "+", 
   RowBox[{"dz", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "sz"}], "+", "tz"}], ")"}]}]}], 
  RowBox[{"4", " ", "\[Pi]", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{{3.7245016235048933`*^9, 3.724501638698999*^9}, 
   3.724502201470463*^9, 3.724608059614175*^9, 3.724608149754229*^9, {
   3.724608361966571*^9, 3.7246083762207117`*^9}, {3.724608430839882*^9, 
   3.724608458104206*^9}},ExpressionUUID->"0c6742d0-a367-48be-9cec-\
a4820c50ca6a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "potential", "]"}]], "Input",
 CellChangeTimes->{{3.724501642656659*^9, 3.7245016472699537`*^9}, {
  3.724608062767519*^9, 
  3.724608065499094*^9}},ExpressionUUID->"3cf6af56-374b-4f63-9d79-\
17f60d377af1"],

Cell["\<\
(dx*(-sx + tx) + dy*(-sy + ty) + dz*(-sz + tz))/
   (4.*Pi*Power(Power(sx - tx,2) + Power(sy - ty,2) + 
       Power(sz - tz,2),1.5))\
\>", "Output",
 CellChangeTimes->{3.724501647593873*^9, 3.724502201531776*^9, 
  3.72460806596288*^9, 3.724608150539497*^9, 3.7246083647907248`*^9, 
  3.724608432493019*^9, 
  3.724608462538772*^9},ExpressionUUID->"2d8674cd-cbff-48a1-bb42-\
86248886ccd0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grad", "[", 
  RowBox[{"potential", ",", "tvec"}], "]"}]], "Input",
 CellChangeTimes->{{3.72460816269942*^9, 
  3.724608179149557*^9}},ExpressionUUID->"5ea88217-388d-4ee2-b2a4-\
55e088667e2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["dx", 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"sx", "-", "tx"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sx"}], "+", "tx"}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sy"}], "+", "ty"}], ")"}]}], "+", 
        RowBox[{"dz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sz"}], "+", "tz"}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}]]}], ",", 
   RowBox[{
    FractionBox["dy", 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"sy", "-", "ty"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sx"}], "+", "tx"}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sy"}], "+", "ty"}], ")"}]}], "+", 
        RowBox[{"dz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sz"}], "+", "tz"}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}]]}], ",", 
   RowBox[{
    FractionBox["dz", 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]], "+", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{"sz", "-", "tz"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dx", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sx"}], "+", "tx"}], ")"}]}], "+", 
        RowBox[{"dy", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sy"}], "+", "ty"}], ")"}]}], "+", 
        RowBox[{"dz", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "sz"}], "+", "tz"}], ")"}]}]}], ")"}]}], 
     RowBox[{"4", " ", "\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.724608169052997*^9, 3.7246081802993107`*^9}, 
   3.72460846622268*^9},ExpressionUUID->"83b806f0-ddd2-4636-9191-\
21c1073df475"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.7246081810201197`*^9, 
  3.724608182853621*^9}},ExpressionUUID->"0f0f210b-bdfc-487f-b055-\
8b5a2472ff5a"],

Cell["\<\
List(dx/(4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),1.5)) + 
    (3*(sx - tx)*(dx*(-sx + tx) + dy*(-sy + ty) + 
         dz*(-sz + tz)))/
     (4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),2.5)),
   dy/(4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),1.5)) + 
    (3*(sy - ty)*(dx*(-sx + tx) + dy*(-sy + ty) + 
         dz*(-sz + tz)))/
     (4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),2.5)),
   dz/(4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),1.5)) + 
    (3*(sz - tz)*(dx*(-sx + tx) + dy*(-sy + ty) + 
         dz*(-sz + tz)))/
     (4.*Pi*Power(Power(sx - tx,2) + 
         Power(sy - ty,2) + Power(sz - tz,2),2.5)))\
\>", "Output",
 CellChangeTimes->{3.724608183395638*^9, 
  3.724608468141429*^9},ExpressionUUID->"4c31fd64-8629-4b96-bf30-\
6db57684d2dc"]
}, Open  ]]
},
WindowSize->{808, 851},
WindowMargins->{{0, Automatic}, {Automatic, 1}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 4, 37, "Input",ExpressionUUID->"ca306d0f-2779-4ed0-90bd-61acd9304593"],
Cell[760, 26, 437, 11, 37, "Input",ExpressionUUID->"31153b42-4d17-40b9-bec3-631bf5c8d205"],
Cell[1200, 39, 460, 11, 37, "Input",ExpressionUUID->"dbfa4bf7-de48-4992-b9db-2e2cd9ed38b8"],
Cell[CellGroupData[{
Cell[1685, 54, 576, 17, 90, "Input",ExpressionUUID->"977ba4e3-bb59-4c04-aa74-8b22d6728978"],
Cell[2264, 73, 1772, 56, 180, "Output",ExpressionUUID->"c1078c33-0d28-40c6-b545-1185caea6461"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4073, 134, 320, 8, 37, "Input",ExpressionUUID->"037c486d-f3f3-46f7-9e4b-ccaa931331f8"],
Cell[4396, 144, 1839, 60, 186, "Output",ExpressionUUID->"dfc5f1bb-78ee-417b-9358-77cac8bd26b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6272, 209, 562, 13, 64, "Input",ExpressionUUID->"ef8f4c78-f28f-4bff-ad9e-18ab9aa2d704"],
Cell[6837, 224, 1087, 33, 70, "Output",ExpressionUUID->"0c6742d0-a367-48be-9cec-a4820c50ca6a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7961, 262, 243, 5, 37, "Input",ExpressionUUID->"3cf6af56-374b-4f63-9d79-17f60d377af1"],
Cell[8207, 269, 400, 9, 101, "Output",ExpressionUUID->"2d8674cd-cbff-48a1-bb42-86248886ccd0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8644, 283, 216, 5, 37, "Input",ExpressionUUID->"5ea88217-388d-4ee2-b2a4-55e088667e2c"],
Cell[8863, 290, 4706, 149, 360, "Output",ExpressionUUID->"83b806f0-ddd2-4636-9191-21c1073df475"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13606, 444, 186, 4, 37, "Input",ExpressionUUID->"0f0f210b-bdfc-487f-b055-8b5a2472ff5a"],
Cell[13795, 450, 931, 22, 435, "Output",ExpressionUUID->"4c31fd64-8629-4b96-bf30-6db57684d2dc"]
}, Open  ]]
}
]
*)

