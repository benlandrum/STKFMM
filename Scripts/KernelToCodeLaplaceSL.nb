(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      7652,        238]
NotebookOptionsPosition[      6245,        205]
NotebookOutlinePosition[      6633,        222]
CellTagsIndexPosition[      6590,        219]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.724499201604269*^9, 
  3.724499204717389*^9}},ExpressionUUID->"ca306d0f-2779-4ed0-90bd-\
61acd9304593"],

Cell[BoxData[
 RowBox[{
  RowBox[{"svec", "=", 
   RowBox[{"{", 
    RowBox[{"sx", ",", "sy", ",", "sz"}], "}"}]}], ";", 
  RowBox[{"tvec", "=", 
   RowBox[{"{", 
    RowBox[{"tx", ",", "ty", ",", "tz"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7244992060428553`*^9, 3.724499224732497*^9}, {
   3.7245014438308477`*^9, 3.7245014904608183`*^9}, 
   3.7246080262028637`*^9},ExpressionUUID->"31153b42-4d17-40b9-bec3-\
631bf5c8d205"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LapSL", "[", 
   RowBox[{"rvec_", ",", "q_"}], "]"}], ":=", 
  RowBox[{"q", "/", 
   RowBox[{"(", 
    RowBox[{"4", "*", "Pi", "*", 
     RowBox[{"Norm", "[", "rvec", "]"}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7245015162985783`*^9, 3.724501597176252*^9}, {
  3.7245016356569777`*^9, 3.724501637599868*^9}, {3.7246080288331547`*^9, 
  3.7246080467842617`*^9}},ExpressionUUID->"dbfa4bf7-de48-4992-b9db-\
2e2cd9ed38b8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"potential", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"LapSL", "[", 
     RowBox[{
      RowBox[{"tvec", "-", "svec"}], ",", "charge"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{
      RowBox[{"tx", ">", "sx"}], "&&", 
      RowBox[{"ty", ">", "sy"}], "&&", 
      RowBox[{"tz", ">", "sz"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7245015996169777`*^9, 3.724501622153934*^9}, {
  3.724608051472252*^9, 3.724608058799665*^9}, {3.724608147710441*^9, 
  3.724608148757471*^9}},ExpressionUUID->"ef8f4c78-f28f-4bff-ad9e-\
18ab9aa2d704"],

Cell[BoxData[
 FractionBox["charge", 
  RowBox[{"4", " ", "\[Pi]", " ", 
   SqrtBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sz", "-", "tz"}], ")"}], "2"]}]]}]]], "Output",
 CellChangeTimes->{{3.7245016235048933`*^9, 3.724501638698999*^9}, 
   3.724502201470463*^9, 3.724608059614175*^9, 
   3.724608149754229*^9},ExpressionUUID->"7c8438c5-ffd8-41aa-b3ce-\
976eb2f26d4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "potential", "]"}]], "Input",
 CellChangeTimes->{{3.724501642656659*^9, 3.7245016472699537`*^9}, {
  3.724608062767519*^9, 
  3.724608065499094*^9}},ExpressionUUID->"3cf6af56-374b-4f63-9d79-\
17f60d377af1"],

Cell["\<\
charge/(4.*Pi*Sqrt(Power(sx - tx,2) + 
       Power(sy - ty,2) + Power(sz - tz,2)))\
\>", "Output",
 CellChangeTimes->{3.724501647593873*^9, 3.724502201531776*^9, 
  3.72460806596288*^9, 
  3.724608150539497*^9},ExpressionUUID->"355f6784-0659-40d0-9cf0-\
2d5d9090037f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grad", "[", 
  RowBox[{"potential", ",", "tvec"}], "]"}]], "Input",
 CellChangeTimes->{{3.72460816269942*^9, 
  3.724608179149557*^9}},ExpressionUUID->"5ea88217-388d-4ee2-b2a4-\
55e088667e2c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"charge", " ", 
     RowBox[{"(", 
      RowBox[{"sx", "-", "tx"}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], ",", 
   FractionBox[
    RowBox[{"charge", " ", 
     RowBox[{"(", 
      RowBox[{"sy", "-", "ty"}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]], ",", 
   FractionBox[
    RowBox[{"charge", " ", 
     RowBox[{"(", 
      RowBox[{"sz", "-", "tz"}], ")"}]}], 
    RowBox[{"4", " ", "\[Pi]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sx", "-", "tx"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sy", "-", "ty"}], ")"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sz", "-", "tz"}], ")"}], "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.724608169052997*^9, 
  3.7246081802993107`*^9}},ExpressionUUID->"7dc5762f-e7eb-46d8-b713-\
d7e521c23c94"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.7246081810201197`*^9, 
  3.724608182853621*^9}},ExpressionUUID->"0f0f210b-bdfc-487f-b055-\
8b5a2472ff5a"],

Cell["\<\
List((charge*(sx - tx))/
    (4.*Pi*Power(Power(sx - tx,2) + Power(sy - ty,2) + 
        Power(sz - tz,2),1.5)),
   (charge*(sy - ty))/
    (4.*Pi*Power(Power(sx - tx,2) + Power(sy - ty,2) + 
        Power(sz - tz,2),1.5)),
   (charge*(sz - tz))/
    (4.*Pi*Power(Power(sx - tx,2) + Power(sy - ty,2) + 
        Power(sz - tz,2),1.5)))\
\>", "Output",
 CellChangeTimes->{
  3.724608183395638*^9},ExpressionUUID->"b175edad-4632-4d23-87bf-\
5dd849a71ecb"]
}, Open  ]]
},
WindowSize->{808, 851},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 199, 4, 37, "Input",ExpressionUUID->"ca306d0f-2779-4ed0-90bd-61acd9304593"],
Cell[760, 26, 437, 11, 37, "Input",ExpressionUUID->"31153b42-4d17-40b9-bec3-631bf5c8d205"],
Cell[1200, 39, 460, 11, 37, "Input",ExpressionUUID->"dbfa4bf7-de48-4992-b9db-2e2cd9ed38b8"],
Cell[CellGroupData[{
Cell[1685, 54, 603, 15, 64, "Input",ExpressionUUID->"ef8f4c78-f28f-4bff-ad9e-18ab9aa2d704"],
Cell[2291, 71, 589, 17, 74, "Output",ExpressionUUID->"7c8438c5-ffd8-41aa-b3ce-976eb2f26d4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2917, 93, 243, 5, 37, "Input",ExpressionUUID->"3cf6af56-374b-4f63-9d79-17f60d377af1"],
Cell[3163, 100, 279, 7, 79, "Output",ExpressionUUID->"355f6784-0659-40d0-9cf0-2d5d9090037f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3479, 112, 216, 5, 37, "Input",ExpressionUUID->"5ea88217-388d-4ee2-b2a4-55e088667e2c"],
Cell[3698, 119, 1843, 59, 186, "Output",ExpressionUUID->"7dc5762f-e7eb-46d8-b713-d7e521c23c94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5578, 183, 186, 4, 37, "Input",ExpressionUUID->"0f0f210b-bdfc-487f-b055-8b5a2472ff5a"],
Cell[5767, 189, 462, 13, 234, "Output",ExpressionUUID->"b175edad-4632-4d23-87bf-5dd849a71ecb"]
}, Open  ]]
}
]
*)

